_your zenodo badge here_

# Sinha\_etal\_2022\_GMD

**The Impact of Crop Rotation and Spatially Varying Crop Parameters in the E3SM Land Model (ELMv2)**

Eva Sinha<sup>1\*</sup>, Ben Bond-Lamberty<sup>2</sup>, Katherine V. Calvin<sup>2</sup>, Beth A. Drewniak<sup>3</sup>, Gautam Bisht<sup>1</sup>, Carl Bernacchi<sup>4,5</sup>, Bethany J. Blakely<sup>5</sup>, and Caitlin E. Moore<sup>5,6</sup>

<sup>1</sup>Pacific Northwest National Laboratory, Richland, WA, United States
<sup>2</sup>Joint Global Change Research Institute, Pacific Northwest National Laboratory, College Park, MD, United States
<sup>3</sup>Argonne National Laboratory, Lemont, IL, United States
<sup>4</sup>Global Change and Photosynthesis Research Unit, USDA-ARS, Urbana, IL, United States
<sup>5</sup>University of Illinois at Urbana‐Champaign, Urbana, IL, United States
<sup>6</sup>School of Agriculture and Environment, The University of Western Australia, Crawley, WA, Australia

\* corresponding author:  eva.sinha@pnnl.gov

## Abstract
Earth System Models (ESMs) are increasingly representing agriculture due to its impact on local and regional climate and fundamental importance for human society.
Realistic large scale simulations may require spatially varying crop parameters and common crop management practices, but their importance is uncertain, and they are often not represented in ESMs. 
In this study, we examine the impact of using constant vs. varying crop parameters on a novel, realistic crop rotation scenario in the Energy Exascale Earth System Model (E3SM) Land Model (ELMv2).
We implemented crop rotation by using ELMv2's dynamic land unit capability, and then calibrated and validated the model against observations collected at three AmeriFlux sites in the US Midwest with corn soybean rotation.
The calibrated model closely captured the magnitude and observed seasonality of carbon and energy fluxes across crops and sites. 
We performed regional simulations for the US Midwest using the calibrated model and found that spatially varying only few crop parameters across the region, as opposed to using constant parameters, had a large impact, with the carbon fluxes varying by up to 40\% and energy fluxes by up to 30\%. 
These results imply that large scale ESM simulations using spatially invariant crop parameters may result in biased flux estimation from agricultural land, and underline the importance of improving human-earth systems interactions in ESMs.

## Journal reference
Sinha, E., Bond-Lamberty B., Calvin, K.V., Bisht, G., Drewniak, B., Bernacchi, C., Blakely, B., Moore, C., 2022. The Impact of Crop Rotation and Spatially Varying Crop Parameters in the E3SM Land Model (ELMv2). (In progress) Journal_TBD, DOI: XXXX



## Code reference
References for each minted software release for all code involved.  

These are generated by Zenodo automatically when conducting a release when Zenodo has been linked to your GitHub repository. The Zenodo references are built by setting the author order in order of contribution to the code using the author's GitHub user name.  This citation can, and likely should, be edited without altering the DOI.

If you have modified a codebase that is outside of a formal release, and the modifications are not planned on being merged back into a version, fork the parent repository and add a `.<shortname>` to the version number of the parent and construct your own name.  For example, `v1.2.5.hydro`.

Human, I.M. (2021, April 14). Project/repo:v0.1.0 (Version v0.1.0). Zenodo. http://doi.org/some-doi-number/zenodo.7777777

## Data reference

### Input data
Reference for each minted data source for your input data.  For example:

1. Andy Suyker (2022), AmeriFlux BASE US-Ne3 Mead - rainfed maize-soybean rotation site, Ver. 12-5, AmeriFlux AMP, (Dataset). https://doi.org/10.17190/AMF/1246086.
2. John Baker, Tim Griffis, Timothy Griffis (2018), AmeriFlux BASE US-Ro1 Rosemount- G21, Ver. 5-5, AmeriFlux AMP, (Dataset). https://doi.org/10.17190/AMF/1246092.
3. Carl J Bernacchi (2022), AmeriFlux BASE US-UiC University of Illinois Maize-Soy, Ver. 1-5, AmeriFlux AMP, (Dataset). https://doi.org/10.17190/AMF/1846665.
4. Hurtt, G. C., Chini, L., Sahajpal, R., Frolking, S., Bodirsky, B. L., Calvin, K., Doelman, J. C., Fisk, J., Fujimori, S., Klein Goldewijk, K., et al.: Harmonization of global land use change and management for the period 850–2100 (LUH2) for CMIP6, Geoscientific Model Development, 13, 5425–5464, 2020. https://doi.org/10.5194/gmd-2019-360.


### Output data
Reference for each minted data source for your output data.  For example:

Human, I.M. (2021). My output dataset name [Data set]. DataHub. https://doi.org/some-doi-number

## Contributing modeling software
| Model | Version | Repository Link | DOI |
|-------|---------|-----------------|-----|
| E3SM | version | https://github.com/E3SM-Project/E3SM | link to DOI dataset |

## Reproduce my experiment

1. Clone and install [E3SM](https://github.com/E3SM-Project/E3SM).
3. Run the following scripts in the `workflow` directory to re-create this experiment:

| Script Name | Description | How to Run |
| --- | --- | --- |
| `step_one.py` | Script to run the first part of my experiment | `python3 step_one.py -f /path/to/inputdata/file_one.csv` |
| `step_two.py` | Script to run the last part of my experiment | `python3 step_two.py -o /path/to/my/outputdir` |

4. Download and unzip the output data from my experiment [Output data](#output-data)
5. Run the following scripts in the `workflow` directory to compare my outputs to those from the publication

| Script Name | Description | How to Run |
| --- | --- | --- |
| `compare.py` | Script to compare my outputs to the original | `python3 compare.py --orig /path/to/original/data.csv --new /path/to/new/data.csv` |

## Reproduce my figures
Use the following scripts found in the `workflow` directory to reproduce the figures used in this publication.

| Script Name | Description | How to Run |
| --- | --- | --- |
| `plot_site_loc.py` | Makes spatial plots showing Ameriflux site locations and three sub-regions of US-Midwest used for the regional run| `python plot_site_loc.py` |
| `plot_corn_soybean_cft_rotation.py` | Makes spatial plot of corn soybean CFT fraction and grid cells with corn soybean rotation | `pythong plot_corn_soybean_cft_rotation.py`|
| `plot_ELM_output.py` | Makes spatial plots comparing impact of constant vs. varying parameters | `python plot_ELM_output.py` |
| `merge_images.py` | Merge images to produce final plot | `merge_images.py` |

## Figures
### Regional analysis
1. [Ameriflux site locations and three sub-regions](figures/fig_Regions.png)
2. [Percent of corn and soybean crop functional type and fraction of grid cells with corn soybean rotation](figures/fig_regional_corn_soybean_cft_rotation/png)
3. [Impact of constant vs. varying parameters on annual GPP](figures/fig_regional_Annual_GPP.png)
4. [Impact of constant vs. varying parameters on annual ER](figures/fig_regional_Annual_ER.png)
5. [Impact of constant vs. varying parameters on latent heat flux for summer](figures/fig_regional_Summer_months_LE.png)
6. [Impact of constant vs. varying parameters on sensible heat flux for summer](figures/fig_regional_Summer_months_H.png)
7. [Comparing simulated annual GPP to FluxCom estimates](figures/fig_regional_GPP_Model_vs_FluxCom.png)
8. [Comparing simulated annual GPP to Madani and Parazoo (2020) estimates](figures/fig_regional_GPP_Model_vs_Madani_et_al.png)
